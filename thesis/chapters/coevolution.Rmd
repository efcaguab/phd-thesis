---
output: html_document
editor_options: 
  chunk_output_type: console
---
\appendix
\addtocontents{toc}{\protect\vspace{1em}}

# Appendix: Cophylogeny {#cophylogeny}

\begin{flushright}{\slshape
    Después reflexioné que todas las cosas le suceden a uno precisamente, precisamente ahora. Siglos de siglos y sólo en el presente ocurren los hechos; innumerables hombres en el aire, en la tierra y el mar, y todo lo que realmente pasa me pasa a mí... } \\ \medskip
    --- \textcite{borges_jardin_1941}
\end{flushright}

## Summary {-}

That evolutionary history can influence the way that species interact is a basic tenet of evolutionary ecology. However, when the role of evolution in determining ecological interactions is investigated, focus typically centers on just one side of the interaction. A cophylogenetic signal---the congruence of evolutionary history across both sides of an ecological interaction---extends these previous explorations and provides a more complete picture of how evolutionary patterns influence the way species interact. To date, cophylogenetic signal has most typically been studied in interactions that occur between fine taxonomic clades that show high intimacy. In this study, we took an alternative approach and made an exhaustive assessment of cophylogeny in pollination interactions. To do so, we assessed the strength of cophylogenetic signal at four distinct scales of pollination interaction: *(i)* across plant-pollinator associations globally, \emph{(ii)} in local pollination communities, *(iii)* within the modular structure of those communities, and \emph{(iv)} in individual modules. We did so using a globally-distributed dataset comprised of 54 pollination networks, over 4000 species, and over 12,000 interactions. Within these data, we detected cophylogenetic signal at all four scales. Cophylogenetic signal was found at the level of plant-pollinator interactions on a global scale and in the majority of pollination communities. At the scale defined by the modular structure within those communities, however, we observed a much weaker cophylogenetic signal. Cophylogenetic signal was detectable in a significant proportion of individual modules and most typically when within-module phylogenetic diversity was low. In sum, the detection of cophylogenetic signal in pollination interactions across scales provides a new dimension to the story of how past evolution shapes extant pollinator-angiosperm interactions.

## Introduction

Populations do not exist in isolation but are instead constantly interacting with each other. 
Each of these interactions can impact the fitness of individuals and hence lead to selection for amplification or avoidance of future interactions [@gervasi_real-time_2017; @thompson_geographic_2005]. 
Furthermore, when interactions directly influence the reproductive isolation of one or both species, selection can be powerful enough to cause speciation or extinction events that can potentially intertwine the evolutionary trajectories of pairs of taxa and their descendants [@thompson_geographic_2005]. 
Where selection, regardless of its origin, is strong enough to drive coupled speciation in two interacting clades, the resultant macroscopic pattern is synonymously referred to as cophylogeny, cospeciation, or parallel cladogenesis [@thompson_geographic_2005; @page_tangled_2003].

A cophylogenetic signal implies two observations: that the phylogenies of interacting clades are congruent in structure and that extant interactions occur between evolutionarily coupled taxa [@page_tangled_2003; @desdevises_cophylogeny_2007; @balbuena_paco_2013]. 
A cophylogenetic signal suggests that contemporary ecological associations among species are the product of coupled evolutionary history such that ancestral forms of each species experienced and responded to shared selection pressures [@page_tangled_2003; @aizen_phylogenetic_2016]. 
In contrast, the current paradigm of phylogenetic signal of species interactions suggests only that more closely related species interact in more similar ways [@rezende_non-random_2007; @gomez_ecological_2010; @rafferty_phylogenetic_2013].
Therefore, cophylogenetic signal in ecological networks would suggest that coupled evolutionary history as well as relatedness can determine species interactions, thereby providing additional insights into the role past evolution plays in determining contemporary ecological associations.
	
To date, the vast majority of studies of cophylogeny have centered on host-parasite relationships [@hafner_phylogenetic_1988; @de_vienne_cospeciation_2013], where the focus is often at the relatively fine scale of families and genera [@weckstein_biogeography_2004; @desdevises_cophylogeny_2007; @hughes_multiple_2007; but see @page_tangled_2003; @chomicki_macroevolutionary_2015]. 
If cophylogenetic signal can also be considered a relevant predictor of ecological interactions, it should be detectable in other types of ecological associations. 
In particular, there is an increasing focus on the mutualistic assemblages of flowering plants and their pollinators as another system in which one might expect to detect a cophylogenetic pattern. 
Several recent studies have demonstrated the presence of cophylogeny at the scales of fig-wasp [@marussich_host-specificity_2007; @jousselin_one_2008; @cruaud_extreme_2012] and yucca-moth [@althoff_geographic_2012] pollination interactions [and see @aizen_phylogenetic_2016]. 
Findings such as these---coupled with the facts that the association of angiosperms and pollinators dates back to the Cretaceous period [@crane_origin_1995; @grimaldi_co-radiations_1999] and that there is reasonable evidence to expect that at least some angiosperms and pollinators co-diverged [@grimaldi_co-radiations_1999]---suggest a cophylogenetic signal may be widely identifiable between these groups (Figure \@ref(fig:fig-conceptual-a)).
On the other hand, perfect congruence of speciation patterns cannot be expected across such rich and diverse groups after more than 100mya of association. 
Nevertheless, even a weak cophylogenetic signal between angiosperms and their pollinators (i.e., at taxonomic scales above the species level) would provide important evidence that coupled evolution between taxa is an important correlate of their tendency to interact. 

```{r fig-conceptual-a, fig.height = fig_sizes()$two_column_width / 1.25, fig.cap = "The first scale of investigation is plant and pollinator interactions globally. We aggregate 54 local pollination communities into a single network to provide a global view of pollination interactions. Here and in the following conceptual figures, we provide a representative example of pollination-interaction structures that are cophylogenetic and non-cophylogenetic. Across all four scales (shown here and in Figure \\ref{fig:fig-conceptual-b}, \\ref{fig:fig-conceptual-c}, and \\ref{fig:fig-conceptual-d}) the key to cophylogenetic signal is that the observed interactions tend to occur between species that show coupled evolutionary history (i.e., their speciation patterns match). Though the general idea is similar across them, our hypothesis tests at each scale address a slightly different question regarding the presence of cophylogenetic signal in pollination interactions.", fig.scap="Plant-pollinator interactions globally", out.extra=''}

conceptual_title <- ggplot() +
  base_ggplot_theme() +
  theme(panel.border = element_blank(), 
        plot.margin = margin(t = 2, b = 0), 
        plot.subtitle = element_text(margin = margin(b = 0)))

conceptual_panel <-  ggplot() +
  base_ggplot_theme() +
  theme(panel.border = element_blank(), 
        plot.margin = margin())

a_title <- conceptual_title +
  labs(title = "ecological scale: plant-pollinator interactions globally", 
       subtitle = "conceptual overview")

a_phylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/a-cophylogeny.png") +
  labs(y = "cophylogenetic\nassemblage") 
  
a_nophylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/a-no_cophylogeny.png") +
  labs(y = "non-cophylogenetic\nassemblage") 

cowplot::plot_grid(a_title, a_phylo, a_nophylo, 
                   rel_heights = c(0.25, 1, 1),
                   ncol = 1, 
                   align = "v")
```

The most relevant scale at which cophylogenetic signal could characterize ecological interactions is that of the community. 
It is already well established that elements of community composition, such as evenness, functional trait diversity and interaction structure have an element of phylogenetic determinism [@webb_phylogenies_2002; @eklof_phylogenetic_2016; @harmon-threatt_filtering_2013; @emerson_phylogenetic_2008; @vamosi_emerging_2009]. 
Hence, even when recognizing the various caveats of a phylogenetic approach to community ecology [@mayfield_opposing_2010; @losos_seeing_2011], there are clear implications should cophylogenetic signal be detectable in ecological communities. 
For instance, many studies have focused on how the evolutionary history of a single group (e.g. forest trees, pollinators) influences community structure [@cavender-bares_phylogenetic_2006; @kembel_phylogenetic_2006; @danieli-silva_pollination_2012]; in contrast, detectable cophylogenetic signal would suggest that observed interactions tend to occur between taxa that show coupled evolutionary history and therefore that the structure of pollination networks is, at least partially, the by-product of this evolutionary coupling of taxa (Figure \@ref(fig:fig-conceptual-b)).
Although recent findings for a set of related networks indicate that cophylogenetic signal may be detectable in pollination networks [@aizen_phylogenetic_2016], it is currently unclear whether or not this is generally the case. 

```{r fig-conceptual-b, fig.height = fig_sizes()$two_column_width / 1.25, fig.cap = "The second scale of investigation are local communities of interacting plants and pollinators that co-occur in a given location. Each community is a subset of the network in \\ref{fig:fig-conceptual-a}. At this level, we are asking if those interactions that are realized in local communities tend to occur between plants and pollinators with the most congruent evolutionary histories.", fig.scap="Plant-pollinator communities", out.extra=''}

b_title <- conceptual_title +
  labs(title = "ecological scale: plant-pollinator communities", 
       subtitle = "conceptual overview")

b_phylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/b-cophylogeny.png") +
  labs(y = "cophylogenetic\nassemblage") 
  
b_nophylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/b-no_cophylogeny.png") +
  labs(y = "non-cophylogenetic\nassemblage") 

cowplot::plot_grid(b_title, b_phylo, b_nophylo, 
                   rel_heights = c(0.25, 1, 1),
                   ncol = 1, 
                   align = "v")
```

At the same time, ecological communities can also be stochastic assemblages of species and interactions [@hubbell_unified_2001; @cottenie_integrating_2005] and the value of examining smaller groups of closely interacting species has been shown time and again [@paine_food_1966; @estes_sea_1974; @olesen_modularity_2007; @rezende_compartments_2009]. 
Therefore, it is entirely possible that a cophylogenetic signal also permeates to finer scales within a community. 
Indeed, ecological networks are known to have identifiable structural features including being characterized by modules of closely interacting subsets of the community [@barber_modularity_2007; @thebault_stability_2010]. 
Modules---a pervasive feature in pollination networks [@olesen_modularity_2007]---are thought to play crucial roles in ecological community resilience [@thebault_stability_2010] and may represent a fundamental unit of coevolution [@olesen_modularity_2007; @bascompte_mutualistic_2014].
As such, these tight sets of interacting species may provide a more ecologically relevant scale at which cophylogenetic signal could act. 
On the one hand, a network's modular structure may show the clearest cophylogenetic signal (Figure \@ref(fig:fig-conceptual-c)). 
On the other hand, many different processes have been causally attributed to ecological module formation [@olesen_modularity_2007; @rezende_compartments_2009; @krasnov_phylogenetic_2012; @rohr_structural_2014; @schleuning_ecological_2014], implying that some individual modules within networks may be better characterized by cophylogenetic signal than others (Figure \@ref(fig:fig-conceptual-d)).

```{r fig-conceptual-c, fig.height = fig_sizes()$two_column_width / 1.25, fig.cap = "The third scale of investigation is with the same local communities as in Figure \\ref{fig:fig-conceptual-b} but examined at the perspective of their modules, where modules group together species based on how likely they are observed to interact. At this scale, we examine how the modular structure of those communities captures cophylogenetic signal. Our hypothesis here derives from the suggestion that the module is the fundamental unit of coevolution and asks whether interactions within modules tend to occur between those species with congruent evolutionary history and vice versa for interactions that fall between modules.", fig.scap="Modular structure of interactions", out.extra=''}

c_title <- conceptual_title +
  labs(title = "ecological scale: modular structure of plant-pollinator networks", 
       subtitle = "conceptual overview")

c_phylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/c-cophylogeny.png") +
  labs(y = "cophylogenetic\nassemblage") 
  
c_nophylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/c-no_cophylogeny.png") +
  labs(y = "non-cophylogenetic\nassemblage") 

cowplot::plot_grid(c_title, c_phylo, c_nophylo, 
                   rel_heights = c(0.25, 1, 1),
                   ncol = 1, 
                   align = "v")
```

```{r fig-conceptual-d, fig.height = fig_sizes()$two_column_width / 1.25, fig.cap = "The fourth and final scale of investigation is at individual modules (groups of frequently interacting plants and pollinators) extracted from Figure \\ref{fig:fig-conceptual-c}. They are also subsets of the local communities in Figure \\ref{fig:fig-conceptual-b}. Many factors are thought to contribute to module formation and cophylogenetic signal may therefore not be observable across all modules in a community. As a result, we assess cophylogenetic signal in individual modules where the interactions of a module should occur between species with congruent evolutionary history more than would be expected by chance.", fig.scap="Individual modules in networks", out.extra=''}

d_title <- conceptual_title +
  labs(title = "ecological scale: individual modules within plant-pollinator networks", 
       subtitle = "conceptual overview")

d_phylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/d-cophylogeny.png") +
  labs(y = "cophylogenetic\nassemblage") 
  
d_nophylo <- conceptual_panel +
  cowplot::draw_image("images/coevolution/d-no_cophylogeny.png") +
  labs(y = "non-cophylogenetic\nassemblage") 

cowplot::plot_grid(d_title, d_phylo, d_nophylo, 
                   rel_heights = c(0.25, 1, 1),
                   ncol = 1, 
                   align = "v")
```

For a network's modular structure to show a cophylogenetic pattern, two constraints must be satisfied (Figure \@ref(fig:fig-conceptual-c)). 
First, the modular structure should embody the phylogenetic congruence of the network such that modules represent groupings of closely related species on each side of the network. 
However, this mapping of each side of the modules to phylogenies does not take into account the degree to which those interactions within modules occur between evolutionarily-coupled plants and pollinators. 
Thus second, a network's modules should also be comprised of the interactions that contribute most to the cophylogenetic signal of the network while interactions that contribute less should tend to fall between modules. 
At the even finer scale of individual modules, a module could be considered to show cophylogenetic signal when just its interactions show greater cophylogenetic signal than expected by chance (Figure \@ref(fig:fig-conceptual-d)).

Here, we explore cophylogenetic signal between plants and their pollinators in 54 pollination networks from around the world that together provide a taxonomically and geographically diverse dataset. 
In particular, we leverage these data to quantify the evidence of cophylogenetic signal at the four distinct scales mentioned previously (Figure \@ref(fig:fig-conceptual-a), \@ref(fig:fig-conceptual-b), \@ref(fig:fig-conceptual-c), and \@ref(fig:fig-conceptual-d)): \emph{(i)} cophylogenetic signal between angiosperms and pollinators globally, \emph{(ii)} community cophylogenetic signal---where evolutionary congruence between species should be embodied by the interactions of the entire network, \emph{(iii)} cophylogenetic signal of a network's modular structure---where the modular structure of a network should tend to contain more closely related plant species, more closely related pollinator species, and the most evolutionarily congruent interactions between them, and \emph{(iv)} individual module cophylogenetic signal---where interactions within a module should be more cophylogenetic than expected by chance. Detectable cophylogenetic signal across these four scales suggests that, at least in plant-pollinator associations, the evolutionary determinants of extant interactions are a product of both interacting species rather than arising from only the phylogenetic relatedness on one side of the interaction.

## Methods

### Empirical data and phylogeny construction

We analyzed a dataset comprised of 54 binary, plant-pollinator mutualistic networks from a wide range of locations around the globe and with diverse species assemblages. 
In each of the networks, the presence or absence of interactions is based on observed visitation of flowering plants by their animal pollinators. In total, these networks include 1,318 species of flowering plants, 2,930 species of pollinators, and over 12,000 unique interactions. 

Studying cophylogenetic signal between two sets of interacting species, such as the flowering plants and pollinators that we examine here, requires an understanding of the evolutionary history of both groups. 
We followed several steps to generate sufficiently well-resolved phylogenies of flowering plants and their pollinators. 
First, to ensure all species identifications were up-to-date, we verified all species' names in the original interaction matrices. 
Plant names were checked and corrected with the NCBI database (http://www.ncbi.nlm.nih.gov/) whereas we corrected animal names with the `resolve` function in the R package `taxize`, which accessed a range of taxonomic databases [@chamberlain_taxize_2014]. 
We combined these species lists with published mega-phylogenies of plants [@zanne_three_2014] and insects [@misof_phylogenomics_2014] to generate dated phylogenetic trees of our data. 
The two published trees provide a backbone for the construction of our phylogenies in that divergence patterns and dates of major lineages can be used as the basis of the phylogenies specific to our data. 
For the plants, major nodes are fully resolved down to the family level (with some dating below the family level). 
For the insect pollinators, the backbone tree provides  resolution to the order level. 
It is most important for cophylogenetic analysis that these major nodes are dated accurately as it is thought that matching at these deeper phylogenetic scales drives observable cophylogenetic signal [@aizen_phylogenetic_2016]. 
Below the family- and order-level, respectively, we largely rely on taxonomic information to infer evolutionary relationships between taxa. 

### Measuring cophylogenetic signal

To conduct a direct assessment of cophylogenetic signal between angiosperms and pollinators across these four scales, we implemented a recently developed Procrustean method: Procrustean Approach to Cophylogeny [PACo; @balbuena_paco_2013].
This approach addresses the cophylogeny problem by optimizing the fit of the phylogeny-interaction graphs of each network [@balbuena_paco_2013]. 
The cophylogenetic signal of each individual interaction is given by the squared residual distance ($r^2$) between the two corresponding points in the phylogenetic graphs. 
PACo thus returns a quantification of the global fit of the phylogenetic objects based on observed interactions as the sum of squared residual distances ($\mathcal{R} = \sum r^2$) between phylogenetic-interaction graphs [@balbuena_paco_2013]. 
As in regression, the smaller the residual distance, the better the fit of the two phylogenies to each other and the more support for a hypothesis of cophylogenetic signal as reflected by the extant interactions.  

PACo, as implemented in R, offers several configuration options [@hutchinson_paco_2017]. 
In this study, we have focused on the results of the symmetric method where the normalized plant graph is superimposed on the normalized pollinator graph. This means that we assessed cophylogenetic signal in terms of the plant phylogeny tracking the pollinator phylogeny since insect lineages preceded angiosperms [@misof_phylogenomics_2014] and pollinators have been shown to drive the evolution of plants [@gervasi_real-time_2017]  . It also implies that $\mathcal{R}$ is standardized with respect to the two phylogenies rather than in units relative to the pollinator phylogeny (as it would with an asymmetric superimposition). Importantly, our results do not differ qualitatively when selecting alternative configuration of PACo arguments.

Currently, there are a range of tools available for undertaking cophylogenetic analysis, and these methods can mainly be sorted into event-based and global-fit methods. 
Event-based methods reconcile one phylogenetic tree with the other by directly assessing evolutionary events (i.e., cospeciation, duplication, host switches) that are explicit in the tree topology [@conow_jane_2010; @drinkwater_towards_2016]. 
Conversely, global-fit methods, such as ParaFit and PACo, aim to assess cophylogeny based on the congruence of observed interactions relative to the phylogenies rather than with the specifics of the phylogenetic topologies [@balbuena_paco_2013; @legendre_statistical_2002].
An important consequence of this difference in approaches is the manner in which significance of the observed cophylogenetic statistic tends to be inferred. 
The randomization approach implemented in PACo (and other global-fit methods) maintains the topology of the phylogeny of each group while shuffling the associations (i.e., interactions) between species to generate random instances of the observed data [@balbuena_paco_2013; @hutchinson_paco_2017]. 
Conversely, event-based methods such as Jane [@conow_jane_2010] and CoRe-PA [@merkle_parameter-adaptive_2010] instead permute the topology of the phylogenies due to their explicit focus on specific events. 
Both approaches have limitations [@balbuena_paco_2013; @drinkwater_towards_2016] and we take a global-fit approach here because it is the most amenable to the data we have and network-centric questions we explore.

Consequently, the approach that we adopt to study cophylogeny necessitates the shuffling of the association matrix to estimate the null distribution [@balbuena_paco_2013; @hutchinson_paco_2017]. 
Rather than allow the results to be driven by variation in species' specificity or generalism, we also constrain this randomization so that each species' number of interactions is maintained when the associations are shuffled [@fortuna_nestedness_2010]. 
For all instances of shuffling the association matrix, we use 1000 permutations of the data to generate the null (and hence to infer significance of the observed pattern); we determined that this number of permutations was sufficient, here and in the related tests that follow below, by assessing convergence of the resulting p-values used for inference. 

### Global-scale cophylogenetic signal

We first used PACo to make a global assessment of cophylogenetic signal between flowering plants and pollinators using the global-scale phylogenies and the aggregate interaction network of our dataset, where all observed interactions between angiosperms and pollinators are represented. 
We assessed the significance of observed cophylogenetic signal at a global scale with a Monte Carlo approach whereby the observed ($\mathcal{R}$) was compared to the same value ($\mathcal{R}^*$) from an ensemble of 1000 randomizations of the aggregated interaction network. 
In each of these randomizations, we conserved the number of interactions for each species as well as the total number of interactions in the network [@fortuna_nestedness_2010]. 
A conservative null model such as this preserves any influence on cophylogenetic signal of the total number of species interactions or the degree distribution meaning that deviation from the null model can be interpreted as due to properties of the particular species that interact rather than network topology.
We considered the cophylogenetic signal of the observed network to be significant if $\mathcal{R}$ was smaller than the null distribution of $\mathcal{R}^*$, at $\alpha=0.05$. Since our hypothesis of significant cophylogenetic signal at the global scale implies that $\mathcal{R}$ should be significantly smaller than the null expectation, we performed one-tailed tests for this global analysis.

To further examine any large-scale geographic patterns, we also constructed continent-specific phylogenies and networks. With the same statistical approach as for the global data, we examined cophylogenetic signal between plants and pollinators at the continental scale. The extent to which the interactions between plants and pollinators at a regional scale showed cophylogenetic signal was assessed for the six continents from which the empirical networks originate (Africa, Asia, Europe, North America, Oceania, South America). We followed the same approach as for the global scale. We assessed whether empirical $\mathcal{R}$ at the regional scale was smaller than its null expectation (i.e., the same null model as above), at $\alpha = 0.05$. 

### Community cophylogenetic signal

We next explored cophylogenetic signal at the scale of pollination communities from two angles. 
First, we assessed the cophylogenetic signal of the species assemblages themselves while maintaining the observed interaction structure---i.e., do the species present in each network represent a more cophylogenetic assemblage than if we were to draw the same number of species randomly from our full phylogenies? 
Second, we assessed the cophylogenetic signal of the interaction network itself---i.e., do the interactions observed in each network occur between more evolutionarily coupled species than we would expect by chance?
To address these questions, we first quantified the cophylogenetic signal of each of the 54 empirical networks. 

#### Cophylogenetic signal based on interaction network

The first assessment of cophylogenetic signal at the community scale was the degree to which realized interactions between plants and pollinators showed a greater cophylogenetic signal than expected by chance. 
If coupled evolution is an important determinant of species interactions then we would expect that the interactions observed in a network show a stronger cophylogenetic signal than expected by chance. 
To make this assessment in our dataset, we constructed a null model whereby observed interactions between pollinators and plants within a network were shuffled to create a randomization of the empirical network. 
The shuffling procedure---identical to that used for the global-scale analysis of cophylogenetic signal---fixes the total number of interactions as well as the degree of plants and pollinators. 
We used a Monte Carlo approach to compare the cophylogenetic signal of observed communities to the same ($\mathcal{R}^*$) from an ensemble of 1000 randomizations of the network. 
We considered the cophylogenetic signal of the observed interaction network to be significant if its $\mathcal{R}$ was smaller than the null distribution, at $\alpha = 0.05$.
		
#### Cophylogenetic signal based on species assemblage

As mentioned earlier, a cophylogenetic signal may be detectable between two species purely because of coupled evolution of their ancestors (rather than the two species themselves). 
Therefore, it was also important to assess whether cophylogenetic signal seen at the community scale was different to that produced by the chance co-occurrence of species and evolutionary coupling between their ancestral states. 
To do so, we constructed a null model whereby pollinators and plants were randomly sampled from the full phylogenies (in equivalent numbers to those observed in the assemblage) and assigned to the interaction network. 
We used a Monte Carlo approach to assess whether or not the cophylogenetic signal seen in observed communities was different to those created by chance with the comparison of an empirical network's $\mathcal{R}$ to the same ($\mathcal{R}^*$) from an ensemble of 1000 randomizations of that network following the outlined approach. 
We considered the cophylogenetic signal of an empirical species assemblage to be significant if its $\mathcal{R}$ was smaller than the null distribution, at $\alpha = 0.05$.

### Modules in pollination networks

To test whether the modular structure of each network and individual modules themselves show a cophylogenetic signal, we first needed to identify modules in each of the interaction networks. 
To do so, we followed the approach proposed by @barber_modularity_2007 and implemented in MODULAR [@marquitti_modular_2014], where nodes in binary bipartite networks are partitioned across modules via a stochastic-optimization procedure---simulated annealing--- to maximize the modularity measure, $Q_B$ [@marquitti_modular_2014]. 
While there are several such methods to assess modularity, the method employed here has been shown to perform as well or better than other contemporary  module detection algorithms in binary bipartite networks [@thebault_identifying_2013].
Although by and large we use binary interaction networks in our analysis, quantitative networks can provide additional information with which to identify modules [@dormann_method_2014]. 
To assess the influence of a quantitative interaction network approach, we also studied the quantitative versions available for 15 of the networks in our dataset. For each of these, we followed the same approach to cophylogenetic signal at the modular scale as for binary networks. 
We undertook all of the analyses that we outline in the following methodological sections for both our full dataset of binary networks and this subset of quantitative networks.
	
### Cophylogenetic signal of a network's modular structure

While the degree to which communities as a whole show cophylogenetic signal could be established purely with PACo [@balbuena_paco_2013], an assessment of the extent to which cophylogenetic signal is manifest in the modular structure of those networks required subsequent analysis. 
To do so, we tested two aspects of a network's modular structure: i) the degree to which closely related species co-occur in modules (for both plants and pollinators) and ii) the degree to which interactions within modules tend to show a stronger cophylogenetic signal than interactions between modules. 
Finally, we used Chi-squared tests to assess the degree to which a significant test statistic for modular structure cophylogenetic signal, plant module phylogenetic signal, or pollinator module phylogenetic signal was related to a significant test statistic in the other two measures.

#### Phylogenetic congruence of module assignments

The first step we took was to quantify how plant and pollinator modules reflect the evolutionary history of each group. To do so, we inferred the phylogenetic signal present in species' module assignments using a likelihood-ratio test [LTR; @cadotte_phylogenies_2018]. 
In the case of phylogenetic signal of a discrete trait, such as module assignment, significant phylogenetic signal is based on the comparison of two candidate models of trait evolution using Pagel's lambda [@pagel_inferring_1999].
In the first model, $\lambda$ is optimized based on the observed tree and observed traits. 
In the second model, the tree is first transformed based on $\lambda = 0$ (i.e. the tree is transformed into a star phylogeny, or, a single, large polytomy) and $\lambda$ is again optimized. 
The degree of phylogenetic signal in the trait---module assignment---can then be inferred with a likelihood-ratio test (LRT) that compares how well each model, or version of the tree, explains the trait data. 
The LRT, therefore, assesses the degree to which the observed tree topology provides a better explanation of module assignment than an uninformative phylogeny. We considered the module assignment of the plant or pollinator species in a network to show significant phylogenetic signal if the fit of the model with the observed tree was significantly better than the fit of the model with the star phylogeny, at $\alpha = 0.05$.
Both models and tree transformations were implemented with the `ape::fitDiscrete` function in R with the lambda transformation and equal-rates model [@paradis_ape_2004] and followed the approach suggested by @pagel_inferring_1999 and reiterated by @cadotte_phylogenies_2018.

#### Cophylogenetic signal within and between modules

The previous analysis describes the degree to which closely-related plants and/or pollinators co-occur in modules.
However, it does not consider the degree to which the interactions within those modules occur between evolutionarily-coupled taxa. 
Therefore, alongside our assessment of module phylogenetic signal, we also assessed the degree to which the modular structure of a pollination network is characterized by cophylogenetic interactions. 
If the modular structure of a network is characterized by a cophylogenetic signal, we expected interactions within modules to have a higher degree of congruence (\emph{i.e.,} have smaller residuals $r$ on average) than interactions between species in different modules. 
To assess whether there was in fact a relationship between $r$ and modular structure in each network, we calculated the average residual distance of interactions within modules $\bar{r}_w$, the average residual distance of interactions that occur between modules $\bar{r}_b$ and defined a test statistic $d_m = \bar{r}_w - \bar{r}_b$. 
We then compared the value of this test statistic to the same ($d_m^*$) for 1000 instances of the empirical network with randomized module assignments. Since our hypothesis of significant cophylogenetic signal in the modular structure of a network implies that the empirical $d_m$ should be significantly smaller than the null expectation, we performed a one-tailed test here.  
	 
To generate null expectations for both of these analyses, we randomized the species' module assignments using two approaches. In the first, more conservative, approach we created random modules for each network by maintaining the observed number of modules and the number of species within each of them (*same-sizes* null model). 
This approach preserves the modular structure of the network and just shuffles species between modules. 
In the second approach, we created random modules for each network by allowing for a random number of species in each module and a random number of modules (*all-sizes* null model). 
An approach such as this reconfigures the network's modular structure by potentially changing the number and size of its modules. Differences between approaches are not substantial and do not qualitatively affect our results or conclusions, therefore we present the results of the first, more conservative approach here. 
	 
### Cophylogenetic signal of individual modules

Finally, we wanted to understand whether and how individual modules within the same network varied in their cophylogenetic signal. 
To do so, we assessed the degree to which each empirical module tends to show a greater cophylogenetic signal than expected by chance. 
For each empirical module, we first generated a distribution of the relationships between the cophylogenetic signal of its interactions and the cophylogenetic signal of interactions in each of 1000 random modules with an equivalent number of randomly sampled interactions. 
Random modules were drawn from randomizations of the networks that preserved connectance and degree distribution (the same null model described earlier for our assessment of cophylogenetic signal the global and community scales). 
In each case, we assessed whether the empirical module shows a stronger cophylogenetic signal than an equivalent random module by comparing the $r$ of all the interactions within the empirical module ($r_i$) to the same for a random module ($r_i^*$) with a Wilcoxon-signed rank test. 
If our hypothesis of stronger cophylogenetic signal in the empirical module can be supported, then $r_i$ should tend to be smaller than $r_i^*$. 
From this distribution of 1000 comparisons of the empirical module with a random module, we were able to characterize a module as significantly cophylogenetic if its interactions tended to be smaller than their random counterparts, at $\alpha = 0.05$. 
Since our hypothesis of significant cophylogenetic signal within a module implies that empirical modules should always show a greater cophylogenetic signal than chance, we performed a one-tailed test here. 

#### Determinants of cophylogenetic signal in individual modules

To better understand variation in cophylogenetic signal between modules, we quantified several module characteristics. 
For each module, we calculated module size (total number of species, plant richness, pollinator richness), module degree (the number of interactions within the module and the total number of interactions of participant species), and the phylogenetic diversity of the module for both plants and pollinators [Faith's PD divided by the total species richness of the module to correct for module size; @faith_conservation_1992]. 
After checking for correlation or near co-linearity between explanatory variables (Pearson's $r < 0.7$), we used a logistic regression to assess the relationship, at $\alpha=0.05$, of \emph{(i)} overall species richness of the module, \emph{(ii)} the proportion of participant species' interactions that occur within the module, and \emph{(iii)} phylogenetic diversity [@faith_conservation_1992] of both flowering plants and pollinators with module cophylogenetic signal. 

#### Distribution of participation in cophylogenetic modules across the phylogeny

Lastly, we examined how the species that made up these modules were distributed across the plant and pollinator phylogenies to assess whether participation in a cophylogenetic module is phylogenetically clustered for either the plants or pollinators. 
To do so, we treated the participation of species in a significantly cophylogenetic module as a binary trait---0 if never found in such a module and 1 if found in at least one such module. Based on this trait, we constructed a distance matrix $m_d$ of cophylogenetic module assignment across all plant species, and the same across all pollinator species.
Note that, in these symmetric distance matrices, species pairs are assigned a 0 if they both participated in any cophylogenetic module or if they both did not, and a 1 otherwise.
We then used a Mantel test to gauge whether or not cophylogenetic module participation as given by the distance matrix $m_d$ was predicted by the phylogenetic relatedness of plants and pollinators, respectively, as captured by the phylogenetic variance-covariance matrix $m_v$. We then compared the $Z$-statistic of the observed matrices to the same ($Z^*$) from an ensemble of 1000 matrix randomizations which preserved the non-independence of the underlying distances with`ape::mantel.test` [@paradis_ape_2004]. 
A significant $Z$-statistic (at $\alpha=0.05$) here indicates that participation in cophylogenetic modules is clustered on the phylogeny more than expected by chance. As participation in cophylogenetic modules may either clustered or over-dispersed on the phylogeny, we undertook a two-tailed test here.
	
### The effect of exotic species on cophylogenetic signal

The final analyses we undertook were an exploration of the effect that exotic species had on the cophylogenetic signal that we detect. To do so, we identified those networks in our analysis that contained exotic species. 
Specifically, we found references to particular exotic species in the original publications of these networks and used that subset of our data to answer this question. In all, nine networks out of the full set of 54 explicitly identified exotic species. 
For these networks, we removed the exotic species identified by the original authors and re-analyzed the data at all scales. 
We assessed cophylogenetic signal at the community scale, at the scale of the modular structure of the community, and within individual modules. 
These results do not show meaningful differences from the case where exotic species are included.

## Results

We first present cophylogenetic analysis of pollination interactions at the global scale where local interaction networks were aggregated into a single conglomerate network.
While our dataset is extensive, it does not fully encompass all flowering plant and pollinator species. 
In terms of representativeness, our global-scale plant phylogeny contains 38 out of 68 recognized orders, 133 out of 489 recognized families, and 761 genera. 
The global-scale pollinator tree contains 24 orders, 263 families, and 1595 genera. 
Despite leaving some taxa unrepresented, there is nonetheless, a significant cophylogenetic signal between plants and pollinators at the global scale (Monte Carlo test, $p < 0.001$). 
Moreover, we split this global dataset into continent specific trees and networks to examine regional patterns in cophylogenetic signal. 
In each region, we see that interactions between pollinators and plants show the same pattern of significant cophylogenetic signal that is seen at the global scale (Monte Carlo tests; all $p < 0.001$).

At the community level, our results show that most pollination communities exhibit a significant cophylogenetic signal. 
The observed interaction patterns of a majority of empirical pollination networks show significant cophylogenetic signal compared to an ensemble of random network structures (38 out of 54 networks; Monte Carlo test, $p<0.05$; Figure \@ref(fig:fig-empirical-cophylogeny)). 
Similarly, a large proportion of empirical networks show significantly stronger cophylogenetic signal than assemblages of plants and pollinators randomly sampled from the full phylogenies (24 out of 54 pollination networks, Monte Carlo test, $p<0.05$; Figure \@ref(fig:fig-empirical-cophylogeny)). 

```{r fig-empirical-cophylogeny, fig.height = fig_sizes()$two_column_width * 0.9, fig.cap = "The degree to which each of the 54 networks in our data set show cophylogenetic signal (CS) at the scale of local communities and their modular structure. On the y-axis, we show these measures of cophylogenetic signal starting with community level cophylogenetic signal of the observed species interaction network and community level cophylogenetic signal of the observed species assemblage. The measures that follow, the phylogenetic signal of both plants and pollinators in the observed modular structure of a network, and the degree to which a network’s modular structure is cophylogenetic, pertain to the assessment of cophylogenetic signal in a community’s modular structure. In each case, a light red square indicates that a network is no different than a null expectation with respect to the measure of interest while a darker red square indicates that the empirical network shows a significantly higher level of the measure than expected by chance. Newtorks were ordered by overal", fig.scap="Empirical cophylogenetic signal", out.extra=''}
loadd(data_coevolution_res)
make_fig_empirical_cophylogeny(data_coevolution_res)
```

The frequent observation of significant cophylogenetic signal at a network scale, such as this, suggests that cophylogenetic signal should also be manifest in the modules of these networks and perhaps more so, given that modules are groups of closely interacting species. 
If module participation is a direct result of cophylogenetic association, we first expected that modules based on who interacts with whom are consistent with the evolutionary histories of both flowering plants and pollinators. 
Here, we instead see that the modular structure of a network is consistent with the pollinator and plant phylogenies in only $43\%$ and $17\%$ of networks, respectively (Monte Carlo test, $p<0.05$; Figure \@ref(fig:fig-empirical-cophylogeny)). 
Our second consideration to assess the cophylogenetic signal of a network's modular structure was the degree to which within-module interactions are more congruent with a cophylogenetic hypothesis than those interactions between modules. 
Here, we find that the modular structure of a network shows a significant cophylogenetic signal in only $9\%$ of the empirical networks (Monte Carlo test, $p<0.05$; Figure \@ref(fig:fig-empirical-cophylogeny)). 

Across our dataset, networks tend to vary in the degree to which their modular structure shows cophylogenetic signal (Figure \@ref(fig:fig-empirical-cophylogeny)). 
Phylogenetic signal of modules for both pollinators and flowering plants is observed at a greater frequency than would be expected at random ($\chi^2$ test, $p < 0.001$ in both cases); however, just two networks appear to satisfy all three constraints for cophylogenetic signal at the scale of a network's modular structure (Figure \@ref(fig:fig-empirical-cophylogeny)). 
As such, a significant result for one aspect of cophylogenetic signal at this scale does not make it more likely for other aspects to also support a hypothesis of cophylogenetic signal ($\chi^2$ tests of both phylogenies conserved, $p<0.001$; plant phylogeny conserved and cophylogenetic grouping of interactions, $p=0.662$; pollinator phylogeny conserved and cophylogenetic grouping of interactions, $p=0.417$; all three constraints, $p=0.662$; Figure \@ref(fig:fig-empirical-cophylogeny)). 
When put together, our results provide rather limited evidence that the entire modular structure of a pollination network is the product of a cophylogenetic association.

A lack of signal at the scale of a network's modular structure does not imply that individual modules within those networks are also poorly characterized by a cophylogenetic signal. 
Indeed, most networks show significant cophylogenetic congruence in at least one module (Figure \@ref(fig:fig-module-cophylogeny)). 
Similarly, significantly more modules (88 out of 349; $\chi^2$ test, $p<0.05$) show a detectable cophylogenetic signal, when aggregating across networks, than would be expected at random (Figure \@ref(fig:fig-module-cophylogeny)). 
Our exploration of the characteristics of cophylogenetic modules with a logistic regression shows that module size and the proportion of participant species' interactions that are within the module are not related to module cophylogenetic signal ($z=0.136$, $p=0.892$ and $z=-0.920$, $p=0.358$, respectively). 
However, the phylogenetic diversities of both flowering plants and pollinators do significantly influence module cophylogenetic signal with increased diversity making cophylogenetic signal less likely ($z=2.225$, $p=0.026$ and $z=4.426$, $p<0.001$, respectively). 
Furthermore, we see that the probability of species appearing in cophylogenetic modules is not equivalent for plants and pollinators. 
For the pollinators there is a significant correlation between cophylogenetic module participation and phylogeny (Mantel test; $p<0.001$) indicating that cophylogenetic module participation is clustered  on the phylogeny. 
Indeed, although the 1151 pollinator species that participate in cophylogenetic modules come from 8 orders, 946 of those species are either hymenopterans or dipterans. 
For the flowering plants, the opposite is true: participation in cophylogenetic modules is not influenced by phylogeny and hence is well distributed across the phylogeny (Mantel test; $p=0.650$).

```{r fig-module-cophylogeny, fig.height = fig_sizes()$two_column_width * 0.9, fig.cap = "There is substantial variation in the extent to which individual modules within networks show cophylogenetic signal. For each of the 54 networks (x-axis), we show the number of modules with significant cophylogenetic signal (darker red) and the number that are non-significant (lighter red). The majority of modules in almost all networks do not show a cophylogenetic signal (261 of 349). However, in 44 of 54 networks at least one module shows a stronger cophylogenetic signal than expected by chance.", fig.scap="Cophylogenetic signal of modules", out.extra=''}
modules_p_value <- "data/coevolution/modules_pvalue.dat"
make_fig_module_cophylogeny(modules_p_value)
```

We also explored the degree to which modules show cophylogenetic signal when those modules are identified from quantitative rather than bipartite interaction networks. 
In all cases, we see qualitatively the same results between binary and quantitative networks. 
In terms of a network's modular structure, the partitioning of species into modules is at least slightly different between the two approaches. 
However, for cophylogenetic signal at the scale of a network's modular structure, the results are nearly identical. 
Cophylogenetic signal at the scale of a network's modular structure was assessed with three separate analyses for each network (Methods). 
In the 45 analyses across these 15 networks, there are only five qualitative changes in the result of an analysis between binary and quantitative versions of a network (i.e., from significant to non-significant or vice versa). 
At the scale of individual modules, we see similar results. The proportion of a network's modules that show significant cophylogenetic signal is often different between binary and quantitative networks but there does not appear to be much consistency to this difference (e.g. four networks show more cophylogenetic modules in the binary version than the quantitative, seven show the opposite pattern, and four are identical).	

Last, we saw that exotic species do not appear to have a marked effect on the cophylogenetic signal that we see in pollination communities or in their modular structure.
The only exception is that the presence of exotic species does appear to dampen cophylogenetic signal at the scale of individual modules. 
However, these analyses should likely be treated as exploratory since exotic species were only found in a small subset of the networks that we studied here.

## Discussion

The primary goal of this study was to examine the potential role of cophylogeny as an evolutionary determinant of ecological interactions. 
Specifically, we have set out to quantify the degree to which a cophylogenetic signal is manifest between flowering plants and their pollinators across a broad dataset and at a range of ecological scales. 
We found that cophylogenetic signal in pollination interactions appears quite commonplace, from the global level of interactions between flowering plants and pollinators to the scale of ecological communities and their internal structure. 
In particular, we find that local communities tend to exhibit a greater degree of cophylogenetic signal than both randomly assembled communities of plants and pollinators with the same network structure and observed pollination communities with a shuffled network structure. 
As such, it appears that the role that evolutionary history plays in determining pollination interactions is not just on one side of the interaction or the other, but can instead be the product of both taxa and the coupled evolutionary history they share. 

In its most basic sense, a cophylogenetic pattern is a macro-evolutionary signature of coupled evolutionary divergence between interacting taxa. 
In some cases---for instance between toucans and chewing lice [@weckstein_biogeography_2004] or amphibians and *Polystoma* [@bentz_historical_2006]---the congruence in phylogenies of interacting clades has been attributed to shared biogeographical pressure such as vicariance [@weckstein_biogeography_2004] or habitat acquisition [@bentz_historical_2006]. 
Given the purported role of biogeographical forces in producing phylogenetic signal [@cavender-bares_merging_2009], the significant cophylogenetic signal that we see at the global scale may be explained by the co-occurence of taxa that have diversified in the same regions and interact due to proximity. 
On the other hand, if clumping of lineages by biogeographical filtering is a strong determinant of the signal that we see, we might expect to see a greater proportion of local communities showing significant signal when compared to random assemablages of species. 
Our results instead suggest that the proportion of local communities showing significant cophylogenetic signal is greater when the null expectation is a randomization of the observed community's interactions rather than when it is a random assemblage of species.

It has also been hypothesized that cophylogenetic signal is most parsimoniously explained by a coevolutionary process [@thompson_geographic_2005; @smith_distinguishing_2008; @godsoe_divergence_2009; @aizen_phylogenetic_2016], even when reciprocal selection need not always result in cospeciation [@thompson_geographic_2005]. 
Indeed, @page_tangled_2003 suggests that ``it is difficult to imagine that cospeciation can occur without at least some degree of coevolution''. 
Clearly, the process or processes that underpin cophylogenetic signal remain an open question.
As such, we focus here on the various implications of cophylogenetic signal across a gradient of ecological scales rather than speculate about the underlying mechanism. 
	
Pollination is a comparatively less intimate and a more variable interaction type [@bascompte_mutualistic_2014] than other systems in which cophylogeny has been studied [@hafner_phylogenetic_1988; @weckstein_biogeography_2004; @desdevises_cophylogeny_2007; @hughes_multiple_2007]. 
Accordingly, the strength of cophylogenetic signal observed here is not as extreme as levels seen in other systems [@hafner_phylogenetic_1988]. 
Nonetheless, empirical associations of plants and pollinators still tend to show a significant cophylogenetic signal. 
Indeed, even when exotic species---who presumably have little coupled evolutionary history with native species---are present, a cophylogenetic signal can still be observed either due to potential evolutionary matching of deep phylogenetic branches between exotic and native taxa [@aizen_phylogenetic_2016], or due to the qualitative nature of our assessment of cophylogenetic signal (i.e., significant vs. non-significant).
Interestingly however, the dampening of cophylogenetic signal by non-native species was more obvious at the scale of individual modules of plants and pollinators. 

Across ecological scales, we observe cophylogenetic signal between plants and pollinators. 
At all scales of pollination association, this implies that while interactions may be predicted by co-occurrence [@gotelli_species_2002] or functional traits [@dehling_functional_2014], it is also important to consider the evolutionary coupling of two taxa as a determinant of their likelihood to interact. 
Perhaps most importantly, when a community does show cophylogenetic signal it also implies that there is phylogenetic congruence on both sides of its pollination interactions rather than only one. 
Our results therefore extend previous conclusions that closely related species in ecological networks tend to interact in similar ways [@rezende_non-random_2007; @gomez_ecological_2010; @fontaine_comparing_2015] and that phylogenetic relatedness influences community assembly [@emerson_phylogenetic_2008] by suggesting that the role of past evolution in determining species interactions is not limited to one side of the interaction but can instead traverse the interaction.

The scale at which we see a less clear-cut cophylogenetic signal is at the level of modules. 
Undoubtedly, modules have fundamental roles in ecological networks as they describe groups of tightly-bound interaction partners [@olesen_modularity_2007]. 
However, a network's modular structure appears to poorly reflect a cophylogenetic signal.
Perhaps this is unsurprising. 
We know that modules in ecological networks can be the product of a suite of processes ranging from ecological to evolutionary and back again [@olesen_modularity_2007; @rezende_compartments_2009; @krasnov_phylogenetic_2012; @rohr_structural_2014; @schleuning_ecological_2014]. 
Therefore, the weak cophylogenetic signal that we observe in the modular structure of pollination networks may be due to the fact that the modules of a community can be the result of a melting pot of ecological and evolutionary processes [@olesen_modularity_2007; @krasnov_phylogenetic_2012; @traveset_invaders_2013; @schleuning_ecological_2014]. 
Having said that, recent work that highlights the differences in the determinants and characterization of modules within a network [@olesen_modularity_2007; @rezende_compartments_2009] suggests the need to focus less on modular structure and more on individual modules themselves.
In particular, if individual modules can be thought of as distinct entities then examining cophylogenetic signal across the modules of an entire community may unnecessarily blur the patterns of cophylogenetic signal present in the modules themselves and the community as a whole. 

Accordingly, we find substantial variation in cophylogenetic signal across individual modules.
While a significant proportion of observed modules are cophylogenetic, they may be closer to the exception than the rule. 
These cophylogenetic modules---that typically show low phylogenetic diversity on both sides of the interaction---appear to be tightly interacting and closely-related groups of flowering plants and pollinators that exhibit both historical *and* contemporary associations. 
The constituent species in these modules appear to be more phylogenetically constrained for the case of pollinators than for plants as most pollinators that participate in cophylogenetic modules belong to the orders diptera and hymenoptera. 

Given that the pollinators in pollination syndromes are thought to be more phylogenetically delimited than plants [@fenster_pollination_2004], that hymenoptera and diptera account for 4 out of 11 pollination syndromes recognized by @ollerton_phenotype_2000, and that these syndromes are thought to be represented by modules [@olesen_modularity_2007], we conclude that future work should aim to understand whether or not the cophylogenetic modules we observe are in fact the manifestation of distinct pollination syndromes. 
Such work could also incorporate the traits of these species alongside their evolutionary history and ecological associations. A clear pattern of cophylogenetic signal and trait-matching within modules may provide the clearest evidence to date in support of @olesen_modularity_2007 hypothesis that modules represent a fundamental unit of coevolution in pollination networks.

Our results contribute a new consideration to the prediction of ecological interactions.
In the face of accelerating global change, the ability to understand why species interact in the way they do has become particularly imperative to ecologists [@tylianakis_global_2008]. 
The breakdown of ecological networks that occurs when species become locally extinct or upon the addition of species through introduction poses a similar challenge to ecologists: how will the community respond? 
In an attempt to address these questions, much work has focused on predicting species interactions and network rewiring [@lopezaraiza-mikel_impact_2007; @memmott_global_2007; @tylianakis_global_2008; @kaiser-bunbury_robustness_2010; @aizen_phylogenetic_2016]. 
The cophylogenetic signal that we have seen in pollination interactions suggests that the coupled evolutionary history of taxa may play an important role in determining whether or not they can and will interact as the community around them changes. 
Given that pollination interactions represent a key ecosystem service, it is particularly important to improve our understanding of why and how particular species interact in the way that they do. 
We expect that our observation of cophylogenetic signal between plants and pollinators provides another valuable step in this process.
	
## Ackwnoledgements {-}

All authors contributed substantially to the study. 
M. C. Hutchinson and D. B. Stouffer conceived the study; M. C. Hutchinson and E. F. Cagua undertook analyses; M. C. Hutchinson, E. F. Cagua, and D. B. Stouffer drafted and edited the manuscript. 
The authors thank all those without whose data this work would be impossible. 
We also thank T. Poisot, J. M. Olesen, S. L. Nuismer, B. Bramon Mora, M. P. Gaiarsa, S. Saavedra, and four anonymous reviewers for invaluable comments on an early version of the manuscript. 
The authors acknowledge T. Poisot for his role in developing the software integral to this study. 
M. C. Hutchinson acknowledges the support of the University of Canterbury Summer Scholarship program.
E. F. Cagua acknowledges the support of both a University of Canterbury Doctoral Scholarship and a University of Canterbury Meadow Mushrooms Postgraduate Scholarship. 
D. B. Stouffer acknowledges the support of a Rutherford Discovery Fellowship, administered by the Royal Society of New Zealand.

## Supporting information {-}

Additional supporting information may be found in the online version of this article at http://onlinelibrary.wiley.com/doi/10.1002/ecy.1955/suppinfo

## Data accessibility {-}

Data available from the Dryad Digital Repository: https://doi.org/10.5061/dryad.8n3q3
